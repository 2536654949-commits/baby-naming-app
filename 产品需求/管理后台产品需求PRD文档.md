# 管理后台产品需求PRD文档

| 文档版本 | V1.0 |
|---------|------|
| 创建日期 | 2025-12-27 |
| 产品类型 | Web管理后台 |
| 目标用户 | 系统管理员、运营人员 |

---

## 目录

1. [产品概述](#1-产品概述)
2. [功能需求](#2-功能需求)
3. [用户故事](#3-用户故事)
4. [交互流程设计](#4-交互流程设计)

---

## 1. 产品概述

### 1.1 产品简介

管理后台是宝宝起名应用的运营管理系统，用于授权码管理、数据统计查看、用户记录查询等核心运营功能。

### 1.2 目标用户

| 用户类型 | 职责 | 使用场景 |
|---------|------|----------|
| 系统管理员 | 系统配置、授权码生成、数据管理 | 日常运营维护 |
| 运营人员 | 数据查看、报表导出、客户服务 | 日常数据分析 |

### 1.3 产品定位

- **V1.5**：简单管理后台，满足基本运营需求
- **V2.0**：完善管理后台，包含数据分析看板

---

## 2. 功能需求

### 2.1 功能架构图

```
┌─────────────────────────────────────────────────────────┐
│                    管理后台系统                          │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  授权码管理  │  │  数据统计    │  │  使用记录    │  │
│  │              │  │              │  │              │  │
│  │ • 批量生成   │  │ • 激活统计   │  │ • 记录查询   │  │
│  │ • 状态查看   │  │ • 使用统计   │  │ • 详情查看   │  │
│  │ • 导出功能   │  │ • 收入统计   │  │ • 数据导出   │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
│                                                          │
│  ┌──────────────────────────────────────────────────┐  │
│  │                   系统管理                        │  │
│  │  • 管理员登录  • 权限控制  • 系统配置          │  │
│  └──────────────────────────────────────────────────┘  │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

### 2.2 功能优先级

| 优先级 | 功能模块 | 说明 |
|--------|---------|------|
| **P0** | 管理员登录 | 核心安全功能，必须实现 |
| **P0** | 授权码生成 | 核心业务功能，必须实现 |
| **P0** | 授权码列表 | 核心查询功能，必须实现 |
| **P1** | 数据统计 | 运营分析，首批实现 |
| **P1** | 使用记录查询 | 客服支持，首批实现 |
| **P2** | 导出功能 | 便捷操作，后续迭代 |
| **P2** | 高级筛选 | 数据分析，后续迭代 |

### 2.3 功能详细规格

#### 功能1：管理员登录 (P0)

**功能描述**：管理员通过用户名和密码登录管理后台

**输入项**：
| 字段 | 类型 | 必填 | 验证规则 |
|------|------|------|----------|
| 用户名 | 文本 | 是 | 已注册的管理员用户名 |
| 密码 | 文本 | 是 | 正确的密码 |

**业务规则**：
1. 用户名和密码验证通过后生成JWT Token
2. Token存储在localStorage中
3. Token有效期：24小时
4. 登录失败3次后锁定账号30分钟

**交互流程**：
```
[访问管理后台]
  → 检查登录状态
  → 未登录 → 显示登录页
  → 输入用户名密码
  → 点击【登录】
  → 验证成功 → 存储Token → 跳转首页
  → 验证失败 → 显示错误提示
```

---

#### 功能2：授权码生成 (P0)

**功能描述**：批量生成授权码，用于销售给用户

**输入项**：
| 字段 | 类型 | 必填 | 说明 | 示例 |
|------|------|------|------|------|
| 生成数量 | 数字 | 是 | 一次生成的授权码数量 | 10 |
| 套餐类型 | 下拉选择 | 是 | 基础版/标准版/豪华版 | 标准版 |
| 有效期 | 数字 | 是 | 授权码有效天数 | 60 |
| 最大使用次数 | 数字 | 是 | 最大起名次数 | 10 |
| 备注 | 文本 | 否 | 批次备注 | 2025年1月批次 |

**套餐预设**：
| 套餐 | 次数 | 有效期 | 价格 |
|------|------|--------|------|
| 基础版 | 5次 | 30天 | ¥29 |
| 标准版 | 10次 | 60天 | ¥49 |
| 豪华版 | 30次 | 90天 | ¥99 |

**授权码格式**：
```
BABY-XXXX-XXXX-XXXX
```
- 前缀：`BABY-`
- 后12位：随机大写字母和数字组合
- 易混淆字符排除：0/O、I/1

**业务规则**：
1. 生成成功后显示授权码列表
2. 支持一键复制所有授权码
3. 支持导出为Excel/CSV
4. 授权码自动保存到数据库，状态为`UNUSED`

**页面布局**：
```
┌─────────────────────────────────────┐
│  生成授权码                          │
├─────────────────────────────────────┤
│                                      │
│  套餐类型: [标准版 ▼]               │
│  生成数量: [10    ]                  │
│  有效期(天): [60    ]               │
│  最大次数: [10    ]                 │
│  备注: [2025年1月批次              ] │
│                                      │
│  ┌────────────────┐                 │
│  │  [生成授权码]   │                 │
│  └────────────────┘                 │
│                                      │
└─────────────────────────────────────┘
```

---

#### 功能3：授权码列表 (P0)

**功能描述**：查看所有授权码的状态和信息

**列表展示字段**：
| 字段 | 说明 |
|------|------|
| 授权码 | BABY-XXXX-XXXX-XXXX |
| 套餐类型 | 基础版/标准版/豪华版 |
| 状态 | 未激活/已激活/已过期 |
| 创建时间 | YYYY-MM-DD HH:mm |
| 激活时间 | YYYY-MM-DD HH:mm（如已激活） |
| 使用次数 | 3/10 |
| 过期时间 | YYYY-MM-DD HH:mm |
| 操作 | 查看/导出 |

**筛选功能**：
- 按状态筛选：全部/未激活/已激活/已过期
- 按套餐类型筛选
- 按创建时间筛选
- 按授权码搜索

**排序功能**：
- 按创建时间排序
- 按激活时间排序
- 按使用次数排序

**操作**：
- 点击授权码查看详情
- 批量导出授权码
- 批量删除过期授权码

**页面布局**：
```
┌───────────────────────────────────────────────────────┐
│  授权码管理                                            │
├───────────────────────────────────────────────────────┤
│  状态: [全部 ▼]  套餐: [全部 ▼]  搜索: [        ]    │
│                                                       │
│  ┌───┬──────────┬────┬────────┬──────┬────────┐      │
│  │选 │ 授权码   │状态│创建时间│使用数│ 操作  │      │
│  ├───┼──────────┼────┼────────┼──────┼────────┤      │
│  │□ │BABY-A3F7 │未激│2025-01 │0/10  │[详情] │      │
│  │   │-92D1    │活  │-01 10: │      │        │      │
│  │   │-4E8C    │    │00      │      │        │      │
│  ├───┼──────────┼────┼────────┼──────┼────────┤      │
│  │□ │BABY-B7G2 │已激│2025-01 │3/10  │[详情] │      │
│  │   │-K4N8    │活  │-01 09: │      │        │      │
│  │   │-M9P1    │    │00      │      │        │      │
│  └───┴──────────┴────┴────────┴──────┴────────┘      │
│                                                       │
│  共 2 条  [导出选中]  [批量删除]                      │
└───────────────────────────────────────────────────────┘
```

---

#### 功能4：授权码详情 (P1)

**功能描述**：查看单个授权码的详细信息和使用记录

**展示内容**：
```
┌─────────────────────────────────────┐
│  授权码详情                          │
├─────────────────────────────────────┤
│                                      │
│  基本信息                            │
│  ─────────────────────              │
│  授权码: BABY-A3F7-92D1-4E8C        │
│  套餐类型: 标准版                    │
│  状态: 已激活                        │
│  创建时间: 2025-01-01 10:00:00      │
│  激活时间: 2025-01-01 15:30:00      │
│  过期时间: 2025-03-01 15:30:00      │
│  最大使用次数: 10                    │
│  已使用次数: 3                       │
│  剩余次数: 7                         │
│  设备指纹: xxxxxxxxxxxxxx            │
│  备注: 2025年1月批次                 │
│                                      │
│  使用记录                            │
│  ─────────────────────              │
│  ┌──────────────────────────────┐  │
│  │ 2025-01-02 10:20  李 男儿... │  │
│  │ → 生成5个名字                │  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │ 2025-01-02 14:50  李 男儿... │  │
│  │ → 生成5个名字                │  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │ 2025-01-03 09:10  王 女...  │  │
│  │ → 生成5个名字                │  │
│  └──────────────────────────────┘  │
│                                      │
│  [返回] [导出记录]                   │
└─────────────────────────────────────┘
```

---

#### 功能5：数据统计 (P1)

**功能描述**：查看系统运营数据统计

**统计维度**：

**1. 概览数据**
| 指标 | 数值 | 说明 |
|------|------|------|
| 总授权码数 | 1,234 | 已生成的授权码总数 |
| 已激活数 | 856 | 已被激活的授权码数 |
| 未激活数 | 378 | 尚未激活的授权码数 |
| 已过期数 | 234 | 已过期的授权码数 |
| 总使用次数 | 5,678 | 累计起名次数 |
| 今日激活 | 12 | 今日新增激活 |
| 今日使用 | 45 | 今日起名次数 |

**2. 收入统计**
- 按时间范围统计：今日/本周/本月/全部
- 收入总额：按激活时间计算
- 套餐分布：各套餐销售占比

**3. 图表展示**
- 激活趋势图：每日激活数量
- 使用趋势图：每日使用次数
- 套餐分布饼图：各套餐占比

**页面布局**：
```
┌───────────────────────────────────────────────────────┐
│  数据统计                                              │
├───────────────────────────────────────────────────────┤
│  时间范围: [本周 ▼]                                    │
│                                                       │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐    │
│  │总授权码  │ │已激活数  │ │未激活数  │ │今日激活  │    │
│  │  1,234  │ │   856   │ │   378   │ │    12   │    │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘    │
│                                                       │
│  激活趋势图                                           │
│  ┌─────────────────────────────────────────────────┐ │
│  │ 50 ┤     ╭─╮                                   │ │
│  │ 40 ┤    ╭╯ ╰╮     ╭─╮                         │ │
│  │ 30 ┤   ╭╯    ╰─╮   ╭╯ ╰╮    ╭╮               │ │
│  │ 20 ┤  ╭╯       ╰─╮ ╭╯    ╰──╭╯╰╮              │ │
│  │ 10 ┤ ╭╯           ╰─╯       ╭╯  ╰─             │ │
│  │  0 ┼──────────────────────────────────          │ │
│  │     一 二 三 四 五 六 日                        │ │
│  └─────────────────────────────────────────────────┘ │
│                                                       │
│  套餐分布                                             │
│  ┌─────────────────────────────────────────────────┐ │
│  │      基础版 30%  ╽                              │ │
│  │    ████                                        │ │
│  │    ████  标准版 50%  ╽                          │ │
│  │    ████████                                    │ │
│  │    ████████  豪华版 20%  ╽                      │ │
│  │    ████████████                                │ │
│  └─────────────────────────────────────────────────┘ │
└───────────────────────────────────────────────────────┘
```

---

#### 功能6：使用记录查询 (P1)

**功能描述**：查询所有用户的起名使用记录

**列表展示字段**：
| 字段 | 说明 |
|------|------|
| 记录ID | 唯一标识 |
| 授权码 | BABY-XXXX-XXXX-XXXX |
| 姓氏 | 用户输入的姓氏 |
| 性别 | 男/女/未知 |
| 出生时间 | 如提供 |
| 生成时间 | YYYY-MM-DD HH:mm |
| 设备指纹 | xxxxxxxxxxxxxx |

**筛选功能**：
- 按时间范围筛选
- 按授权码筛选
- 按姓氏搜索
- 按性别筛选

**详情查看**：
- 点击记录查看完整信息
- 查看AI返回的名字结果
- 查看用户特殊要求

**页面布局**：
```
┌───────────────────────────────────────────────────────┐
│  使用记录                                              │
├───────────────────────────────────────────────────────┤
│  时间: [最近7天 ▼]  姓氏: [ ]  授权码: [ ]  [查询]   │
│                                                       │
│  ┌──────┬──────────┬────┬──────────┬────────┐       │
│  │时间  │ 姓氏     │性别│ 授权码   │ 操作  │       │
│  ├──────┼──────────┼────┼──────────┼────────┤       │
│  │2025-│李        │男  │BABY-A3F7 │[详情] │       │
│  │01-02 │          │    │-92D1... │        │       │
│  │10:20 │          │    │         │        │       │
│  ├──────┼──────────┼────┼──────────┼────────┤       │
│  │2025-│王        │女  │BABY-B7G2 │[详情] │       │
│  │01-02 │          │    │-K4N8... │        │       │
│  │14:50 │          │    │         │        │       │
│  └──────┴──────────┴────┴──────────┴────────┘       │
│                                                       │
│  共 2 条  [导出数据]                                  │
└───────────────────────────────────────────────────────┘
```

---

#### 功能7：数据导出 (P2)

**功能描述**：导出各类数据为Excel/CSV格式

**导出类型**：
1. 授权码导出
   - 选中导出：导出选中的授权码
   - 按条件导出：按筛选条件导出
   - 全量导出：导出所有授权码

2. 使用记录导出
   - 按时间范围导出
   - 按授权码导出

**导出格式**：
- Excel (.xlsx)
- CSV (.csv)

**导出内容**：
- 授权码：授权码、状态、创建时间、激活时间、使用次数等
- 使用记录：时间、姓氏、性别、出生信息、授权码等

---

#### 功能8：系统配置 (P2)

**功能描述**：管理系统配置参数

**配置项**：
| 配置项 | 说明 | 示例值 |
|--------|------|--------|
| 智谱API Key | AI服务密钥 | df6c2557... |
| 套餐配置 | 各套餐的次数和有效期 | 见上文套餐表 |
| 管理员IP白名单 | 允许访问后台的IP地址 | xxx.xxx.xxx.xxx |
| 登录失败锁定阈值 | 连续失败多少次锁定 | 3次 |
| 锁定时间 | 账号锁定时长 | 30分钟 |

---

## 3. 用户故事

### 故事1：管理员登录
```
作为一个 系统管理员
我想要 登录管理后台
以便于 进行授权码管理和数据查看

验收标准：
- 输入正确的用户名密码后能够成功登录
- 登录后能够跳转到管理后台首页
- 输入错误密码时有明确提示
- 支持记住登录状态
```

### 故事2：批量生成授权码
```
作为一个 管理员
我想要 批量生成授权码
以便于 销售给用户

验收标准：
- 能够选择套餐类型快速填充配置
- 能够设置生成数量
- 生成后能够查看所有授权码
- 支持复制和导出授权码
```

### 故事3：查看授权码状态
```
作为一个 运营人员
我想要 查看授权码的激活和使用状态
以便于 了解销售情况

验收标准：
- 能够看到所有授权码的列表
- 能够按状态筛选授权码
- 能够查看单个授权码的详细信息
- 能够看到授权码的使用记录
```

### 故事4：查看运营数据
```
作为一个 运营人员
我想要 查看系统的运营统计数据
以便于 分析业务表现

验收标准：
- 能够看到激活数、使用数等概览数据
- 能够查看不同时间范围的数据
- 能够看到趋势图表
- 能够看到套餐分布情况
```

### 故事5：查询使用记录
```
作为一个 客服人员
我想要 查询用户的使用记录
以便于 解决用户问题

验收标准：
- 能够按授权码查询使用记录
- 能够看到每次起名的详细信息
- 能够看到AI生成的名字结果
- 支持导出记录数据
```

---

## 4. 交互流程设计

### 4.1 整体用户旅程

```
┌─────────────┐
│  访问后台    │
└──────┬──────┘
       │
       ▼
┌─────────────┐       ┌──────────────┐
│ 管理员登录   │  No   │  提示错误    │
│  验证身份    │◄──────│  重新登录    │
└──────┬──────┘       └──────────────┘
       │ Yes
       ▼
┌─────────────┐
│ 后台首页    │
│  数据概览   │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│ 选择功能    │
│  ├─授权码   │
│  │  管理    │
│  ├─数据     │
│  │  统计    │
│  └─使用     │
│     记录    │
└─────────────┘
```

### 4.2 页面跳转关系

```
/admin/login (登录页)
  │
  └─→ /admin (首页/数据概览)
        │
        ├─→ /admin/codes (授权码管理)
        │      ├─→ /admin/codes/generate (生成授权码)
        │      └─→ /admin/codes/:id (授权码详情)
        │
        ├─→ /admin/stats (数据统计)
        │
        └─→ /admin/records (使用记录)
               └─→ /admin/records/:id (记录详情)
```

### 4.3 核心交互流程

#### 授权码生成流程
```
[进入生成页面]
  → 选择套餐类型（自动填充次数和有效期）
  → 输入生成数量
  → 可选输入备注
  → 点击【生成授权码】
  → 确认弹窗
  → 后端生成授权码
  → 显示生成的授权码列表
  → 可选择复制或导出
  → 完成
```

#### 授权码查询流程
```
[进入授权码列表]
  → 显示所有授权码
  → 应用筛选条件（可选）
  → 点击某个授权码
  → 进入详情页
  → 查看授权码信息和使用记录
  → 返回列表
```

---

## 5. API接口说明

管理后台需要的API接口：

```
POST   /api/admin/login              # 管理员登录
GET    /api/admin/stats              # 获取统计数据
POST   /api/admin/codes              # 生成授权码
GET    /api/admin/codes              # 获取授权码列表
GET    /api/admin/codes/:id          # 获取授权码详情
DELETE /api/admin/codes/:id          # 删除授权码
GET    /api/admin/records            # 获取使用记录
GET    /api/admin/records/:id        # 获取记录详情
GET    /api/admin/export/codes       # 导出授权码
GET    /api/admin/export/records     # 导出使用记录
GET    /api/admin/config             # 获取系统配置
PUT    /api/admin/config             # 更新系统配置
```

---

**文档结束**
